(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{25:function(e,t,a){e.exports=a(57)},30:function(e,t,a){},34:function(e,t,a){},57:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),o=a(10),i=a.n(o),l=(a(30),a(32),a(4)),c=a(5),s=a(8),u=a(6),m=a(7),h=(a(34),a(3)),g=a(11),p=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).state={modal:!1},a.toggle=a.toggle.bind(Object(h.a)(Object(h.a)(a))),a.confirm=a.confirm.bind(Object(h.a)(Object(h.a)(a))),a.unlink=a.unlink.bind(Object(h.a)(Object(h.a)(a))),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"confirm",value:function(e){e.preventDefault(),this.toggle(),this.props.confirm()}},{key:"unlink",value:function(e){e.preventDefault(),this.props.unlink(),this.confirm(e)}},{key:"toggle",value:function(){this.setState({modal:!this.state.modal})}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("button",{className:"nav-link",href:"#",onClick:this.toggle},this.props.children),r.a.createElement(g.b,{isOpen:this.state.modal,toggle:this.toggle,contentClassName:"bg-dark"},r.a.createElement(g.c,null,this.props.text),r.a.createElement(g.d,null,r.a.createElement(g.a,{color:"primary",onClick:this.confirm},this.props.confirmText),this.props.unlink&&r.a.createElement(g.a,{color:"danger",onClick:this.unlink},"Unlink"),r.a.createElement(g.a,{color:"secondary",onClick:this.toggle},"Cancel"))))}}]),t}(r.a.Component),b=a(12),f=a.n(b),d=window.location.protocol+"//"+window.location.host,v=function(){this.login=function(){localStorage.setItem("callback",!0),window.location.href=d+"/auth/twitter"},this.logout=function(){localStorage.removeItem("user"),localStorage.removeItem("location"),localStorage.removeItem("token")},this.unlink=function(){var e={Authorization:"Bearer "+(localStorage.getItem("token")||"")};return f.a.post(d+"/auth/unlink",{},{headers:e,withCredentials:!0})},this.callbackToken=function(){return f.a.get(d+"/auth/get-user",{withCredentials:!0})},this.tokenCheck=function(){var e=localStorage.getItem("user");(e?JSON.parse(e).exp:"")<Date.now()/1e3&&this.logout()},this.updateUser=function(e){e.twitter=JSON.parse(e.twitter),localStorage.setItem("user",JSON.stringify(e)),localStorage.setItem("token",e.token)},this.getUserName=function(){var e=localStorage.getItem("user");return e?JSON.parse(e).username:""}},k=new v,E=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).state={loading:"",username:""},a.login=a.login.bind(Object(h.a)(Object(h.a)(a))),a.logout=a.logout.bind(Object(h.a)(Object(h.a)(a))),a.unlink=a.unlink.bind(Object(h.a)(Object(h.a)(a))),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"login",value:function(){k.login()}},{key:"logout",value:function(){k.logout(),this.setState({username:""}),window.location.reload()}},{key:"unlink",value:function(){var e=this;k.unlink().then(function(t){e.logout()}).catch(function(e){console.error(e)})}},{key:"render",value:function(){return r.a.createElement("nav",{className:"navbar navbar-dark navbar-expand-lg bg-dark"},r.a.createElement("div",{className:"container"},r.a.createElement("span",{className:"navbar-brand",href:"#"},"Night Life App"),k.getUserName()&&r.a.createElement("ul",{className:"nav navbar-nav"},r.a.createElement("span",{className:"navbar-text"},"Welcome ",k.getUserName()),r.a.createElement("li",{className:"nav-item"},r.a.createElement(p,{confirm:this.logout,confirmText:"Logout",unlink:this.unlink,text:"Click Unlink to remove your account from the site"},r.a.createElement("i",{className:"fa fa-sign-out","aria-hidden":"true"})," Logout"))),!k.getUserName()&&r.a.createElement("ul",{className:"navbar-nav"},r.a.createElement("li",{className:"nav-item"},r.a.createElement(p,{confirm:this.login,confirmText:"Login",text:"Logging in will require using cookies"},r.a.createElement("i",{className:"fa fa-sign-in","aria-hidden":"true"})," Login")))))}}]),t}(r.a.Component),N=new v,O=function(e){function t(){return Object(l.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"displayStars",value:function(e){return e.map(function(e,t){return r.a.createElement("span",{key:"star"+t},r.a.createElement("i",{className:e+" fa-2x","aria-hidden":"true"}))})}},{key:"opting",value:function(){this.props.opting(this.props.bar.name,!this.props.bar.going)}},{key:"render",value:function(){return r.a.createElement("div",{className:"card mt-3 bg-dark text-white"},r.a.createElement("div",{className:"card-header"},r.a.createElement("div",{className:"row"},r.a.createElement("h2",{className:"col-7"},this.props.bar.name),r.a.createElement("div",{className:"col-5 mr-auto text-right"},this.displayStars(this.props.bar.stars)))),r.a.createElement("div",{className:"card-body"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-4"},r.a.createElement("img",{className:"img-thumbnail img-fluid rounded float-left maxheight",src:this.props.bar.image,alt:this.props.bar.name})),r.a.createElement("div",{className:"col-5 text-left"},this.props.bar.address.map(function(e,t){return r.a.createElement("span",{key:"line"+t},e,r.a.createElement("br",null))}),r.a.createElement("br",null),this.props.bar.phone.substr(3)),r.a.createElement("div",{className:"col-3 text-right"},r.a.createElement("a",{href:this.props.bar.yelpUrl,target:"_blank",rel:"noopener noreferrer"},this.props.bar.reviewCount," Reviews")),r.a.createElement("hr",null))),r.a.createElement("div",{className:"card-footer"},r.a.createElement("h4",null,this.props.bar.people," Going",N.getUserName()?r.a.createElement("button",{className:"btn btn-primary float-right",onClick:this.opting.bind(this)},this.props.bar.going?"I Want Out":"I Want In"):r.a.createElement("button",{className:"btn btn-info float-right",disabled:!0},"Log In to Opt In"))))}}]),t}(r.a.Component),y=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).state={filterText:"",filterType:""},a.onChange=a.onChange.bind(Object(h.a)(Object(h.a)(a))),a.sort=a.sort.bind(Object(h.a)(Object(h.a)(a))),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"onChange",value:function(e){e.preventDefault(),this.setState({filterText:e.target.value.toLowerCase()})}},{key:"generateBars",value:function(e){var t=this,a=JSON.parse(JSON.stringify(e));switch(this.state.filterType){case"name":a=a.sort(function(e,t){return e.name>t.name});break;case"rating":a=a.sort(function(e,t){return e.rating<t.rating});break;case"going":a=a.filter(function(e){return e.going})}return(a=a.filter(function(e){return e.name.toLowerCase().indexOf(t.state.filterText)>-1})).length?a.map(function(e,a){return r.a.createElement(O,{key:"bar"+a,bar:e,opting:t.props.opting})}):r.a.createElement("h2",null,"No Bars")}},{key:"sort",value:function(e){e.preventDefault();var t=" active";e.target.className.indexOf("active")>-1&&(t=""),document.getElementById("name").className="btn btn-outline-primary",document.getElementById("rating").className="btn btn-outline-primary",document.getElementById("going").className="btn btn-outline-primary",e.target.className+=t,t?this.setState({filterType:e.target.id}):this.setState({filterType:"",bars:this.props.bars})}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("hr",null),r.a.createElement("div",{className:"row justify-content-center"},r.a.createElement("div",{className:"col-lg-8"},r.a.createElement("div",{id:"filter-input",className:"input-group"},r.a.createElement("div",{className:"input-group-prepend"},r.a.createElement("span",{className:"input-group-text",id:"basic-addon2"},"Filter")),r.a.createElement("input",{className:"form-control bg-dark text-white",name:"filter",type:"text",onChange:this.onChange,placeholder:"filter"}),r.a.createElement("div",{className:"input-group-append",role:"group"},r.a.createElement("button",{type:"button",className:"btn btn-outline-primary",id:"name",onClick:this.sort},"Name"),r.a.createElement("button",{type:"button",className:"btn btn-outline-primary",id:"rating",onClick:this.sort},"Rating"),r.a.createElement("button",{type:"button",className:"btn btn-outline-primary",id:"going",onClick:this.sort},"Going"))))),r.a.createElement("div",null,this.generateBars(this.props.bars)))}}]),t}(r.a.Component),j=new function(){var e=function(){return localStorage.getItem("token")||""};this.search=function(t){var a={Authorization:"Bearer "+e()},n=d+"/api/search/?location="+t;return f.a.get(n,{headers:a})},this.going=function(t){var a={Authorization:"Bearer "+e()};return f.a.post(d+"/api/going/",{barName:t,going:!0},{headers:a})},this.notGoing=function(t){var a={Authorization:"Bearer "+e()};return f.a.post(d+"/api/going/",{barName:t,going:!1},{headers:a})}},w=new v,S=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).state={search:"",bars:[],loading:!1,error:""},a.search=a.search.bind(Object(h.a)(Object(h.a)(a))),a.submitSearch=a.submitSearch.bind(Object(h.a)(Object(h.a)(a))),a.opting=a.opting.bind(Object(h.a)(Object(h.a)(a))),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=localStorage.getItem("location");e&&w.getUserName()&&(this.searchRequest(e),this.setState({search:e}))}},{key:"updateGoing",value:function(e,t){for(var a=0,n=!1,r=JSON.parse(JSON.stringify(this.state.bars));a<r.length||!n;)r[a].name===e&&(r[a].going=t,r[a].people+=t?1:-1,n=!0),a++;this.setState({bars:r})}},{key:"opting",value:function(e,t){var a=this;this.setState({error:""}),(t?j.going(e):j.notGoing(e)).then(function(n){a.updateGoing(e,t)}).catch(function(e){console.error(e),a.setState({error:"Error updating going status"})})}},{key:"search",value:function(e){e.preventDefault(),this.setState({search:e.target.value})}},{key:"submitSearch",value:function(e){e.preventDefault(),this.state.search?this.searchRequest(this.state.search):this.setState({bars:[]})}},{key:"searchRequest",value:function(e){var t=this;this.setState({loading:!0,bars:[],error:""}),j.search(e).then(function(e){var a=e.data.bars||[];localStorage.setItem("location",e.data.location),t.setState({bars:a,loading:!1})}).catch(function(e){console.error(e),localStorage.removeItem("location"),t.setState({error:"Error Searching"})})}},{key:"render",value:function(){return r.a.createElement("div",{className:"container content"},r.a.createElement("br",null),r.a.createElement("div",{className:"row justify-content-center"},r.a.createElement("form",{className:"input-group col-lg-6"},r.a.createElement("input",{className:"form-control bg-dark text-white",placeholder:"search",value:this.state.search,onChange:this.search}),r.a.createElement("div",{className:"input-group-append",role:"group"},r.a.createElement("button",{type:"submit",className:"btn btn-primary",id:"submit-search",onClick:this.submitSearch},"Search")))),this.state.loading&&r.a.createElement("h1",null,"Loading..."),!!this.state.bars.length&&r.a.createElement(y,{bars:this.state.bars,opting:this.opting}))}}]),t}(r.a.Component),C=function(e){function t(){return Object(l.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement("footer",{className:"navbar footer"},r.a.createElement("div",{className:"container"},r.a.createElement("small",{className:"mx-auto"},r.a.createElement("a",{href:"https://www.freecodecamp.com/challenges/build-a-nightlife-coordination-app",target:"_blank",rel:"noopener noreferrer"},"FCC Night Life App")," |",r.a.createElement("a",{href:"https://github.com/mtharmen/night-life-app",target:"_blank",rel:"noopener noreferrer"},"GitHub Repo ",r.a.createElement("i",{className:"fa fa-github","aria-hidden":"true"}))," |",r.a.createElement("a",{href:"http://fontawesome.io/",target:"_blank",rel:"noopener noreferrer"},"Font Awesome ",r.a.createElement("i",{className:"fa fa-font-awesome","aria-hidden":"true"}))," |",r.a.createElement("a",{href:"https://www.yelp.com/",target:"_blank",rel:"noopener noreferrer"},"Search Results from Yelp ",r.a.createElement("i",{className:"fa fa-yelp","aria-hidden":"true"})))))}}]),t}(r.a.Component),x=new v,I=(localStorage.location,function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).state={loading:!1},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){localStorage.getItem("callback")?this.callback():x.tokenCheck()}},{key:"callback",value:function(){var e=this;localStorage.removeItem("callback"),this.setState({loading:!0}),x.callbackToken().then(function(t){x.updateUser(t.data);x.getUserName();e.setState({loading:!1})}).catch(function(t){e.setState({loading:!1}),console.error(t)})}},{key:"render",value:function(){return r.a.createElement("div",null,!this.state.loading&&r.a.createElement("span",null,r.a.createElement(E,null),r.a.createElement(S,null),r.a.createElement(C,null)),this.state.loading&&r.a.createElement("h1",null,"Loaading..."))}}]),t}(r.a.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(I,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[25,2,1]]]);
//# sourceMappingURL=main.7098c9da.chunk.js.map